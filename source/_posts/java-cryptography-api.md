---
title: Java 加密篇之算法总结
date: 2018-06-01 22:36:24
updated:
tags: [Java, 安全]
typora-root-url: ..
---

![encryption_algorithm](/img/security/encryption_algorithm.png)

数字签名作为维护数据信息安全的重要方法之一，可以解决伪造、抵赖、冒充和篡改等问题。其主要作用体现在以下几个方面：

- 防冒充（身份认证）。在数字签名中，当使用私钥签名时，如果接收方或验证方用其公钥进行验证并获通过，那么可以肯定，签名人就是拥有私钥的那个人，因为私钥只有签名人拥有，其他人不可能冒充签名者。
- 防伪造。其他人不能伪造对数据的签名，因为私钥只有签名者自己拥有，所以其他人不可能构造出正确的签名结果数据。
- 防篡改。私钥加签后的摘要和数据一起发送给接收者，一旦信息被篡改，接收者可通过计算摘要和验证签名来判断该文件无效，从而保证了文件的完整性。
- 防抵赖。数字签名既可以作为身份认证的依据，也可以作为签名者签名操作的证据。要防止接收者抵赖，可以在数字签名系统中要求接收者返回一个自己签名的表示收到的报文，给发送者或受信任第三方。如果接收者不返回任何消息，此次通信可终止或重新开始，签名方也没有任何损失，由此双方均不可抵赖。
- 保密性。手写签字的文件一旦丢失，文件信息就极可能泄露。但在网络传输中，数字签名的公钥可以用于加密报文，以保证信息机密性。

# 单向加密算法

又称为不可逆加密算法，使用**单向散列函数**实现。一般用于生成消息摘要（Digest），可用于对数据进行签名和验签，以保证数据的：

* 完整性（Integrity）
* 真实性（Authenticity）
* 不可抵赖性（Non-repudiation）

例如下图摘要（Digest）由 `SHA-1` 生成。`SHA1` 摘要长度为 20 Bytes (160 bit)，一般用 40 位十六进制数表示（4 bit (2^4) = 1 位十六进制数，因此为 160 bit / 4 = 40 位十六进制数）：

![digest](/img/security/digest.png)



## MD

https://www.baeldung.com/java-md5

## SHA

https://www.baeldung.com/sha-256-hashing-java

## HMAC

What is an HMAC?

> A *[hash-based message authentication code (HMAC, 散列消息认证码)](https://en.wikipedia.org/wiki/HMAC)* is a type of message authentication code involving:
>
> - a cryptographic hash function
> - a secret cryptographic key
>
> ![HMAC](/img/security/hmac-in-java.webp)
>
> If any change is made to the data being sent, the resulting HMAC will be completely different from the original. Additionally, since the key is known only to the sender and the receiver, no valid HMAC can be regenerated by anyone else.

HMAC 使用场景 —— HTTP 请求参数校验

> All you need to do is take the HTTP request body and apply the SHA-256 hash function to it, using the **secret key** as the hash key. You then compare the resulting HMAC to the one contained in the **Signature header**:
>
> - If the HMACs are identical, then the data corresponds to what sender sent. 
> - If they are different, this indicates that the data has been intercepted and altered in some way.

实现方案：

https://www.baeldung.com/java-hmac

# 对称加密算法

![symmetric_encryption](/img/security/symmetric_encryption.png)

## 3DES

https://www.baeldung.com/java-3des

## AES

https://www.baeldung.com/java-secure-aes-key

https://www.baeldung.com/java-aes-encryption-decryption

# 非对称加密算法

https://www.baeldung.com/java-rsa

## 公钥加密，私钥解密

![asymmetric_encryption](/img/security/asymmetric_encryption.png)

## 私钥签名，公钥验签

![sign](/img/security/sign.png)

# 参考

